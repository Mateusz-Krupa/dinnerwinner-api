drop table if exists ingredients cascade;
drop table if exists recipes cascade;
drop table if exists user_recipe cascade;
drop table if exists _user cascade;

create table ingredients (id bigint generated by default as identity, name varchar(255), unit varchar(255), weight float(24) not null, recipe_id bigint, primary key (id));
create table recipes (id bigint generated by default as identity, description varchar(255), name varchar(255), primary key (id));
CREATE TABLE _user (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    email VARCHAR(255) NOT NULL,
    firstname VARCHAR(255) NOT NULL,
    lastname VARCHAR(255) NOT NULL,
    password VARCHAR(255) NOT NULL,
    role VARCHAR(255) NOT NULL
);

CREATE TABLE token (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    token VARCHAR(255) NOT NULL,
    token_type VARCHAR(255) NOT NULL,
    revoked BOOLEAN NOT NULL,
    expired BOOLEAN NOT NULL,
    user_id INT,
    FOREIGN KEY (user_id) REFERENCES user(id) ON DELETE CASCADE
);


alter table if exists ingredients add constraint FK7p08vcn6wf7fd6qp79yy2jrwg foreign key (recipe_id) references recipes;
alter table if exists user_recipe add constraint FKmd009vkvaogv802f82wnlefo4 foreign key (recipe_id) references recipes;
